{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  {% block extra_css %}
  <!-- Primero, incluir la libreria de JpegCam -->
  <script src="/static/jpegcam/webcam.js"></script>
  {% endblock extra_css %}
    <link rel="apple-touch-icon" sizes="76x76" href="../static/img/apple-icon.png">
    <link rel="icon" type="image/png" href="../static/img/kit-11.png">

    <!-- <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta http-equiv="cache-control" content="max-age=0" />
  <meta http-equiv="cache-control" content="no-cache" />
  <meta http-equiv="expires" content="0" />
  <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
  <meta http-equiv="pragma" content="no-cache" /> -->
  <title>
    {% block title %}
    KIT Online Exam
    {% endblock title %}
  </title>
  <style>
    h1 {
      font-size: 2em;
      font-weight: bold;
      color: #777777;
      text-align: center
    }
    table {
      margin: auto;
    }
    input[type=submit] {
    width: 45%;
    background-color: #04043E;
    color: white;
    padding: 11px 0px;
    margin-bottom: 30px;
    /*margin: 8px 0;*/
    border: none;
    /*margin-left: 200px;*/
    border-radius: 4px;
    cursor: pointer;
}

input[type=submit]:hover {
    background-color: green;
}
body {font-size:100%}
  </style>
  <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no' name='viewport' />
  <!--     Fonts and icons     -->
  <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:400,700|Material+Icons" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css">
  <!-- CSS Files -->
  <link rel='stylesheet' href="{% static 'css/material-kit.css' %}">
  <!-- CSS Just for demo purpose, don't include it in your project -->
  <link rel='stylesheet' href="{% static 'demo/demo.css' %}">
  <!-- <link rel='stylesheet' href="{% static 'css/register.css' %}"> -->
  <!-- <link href="../assets/demo/demo.css" rel="stylesheet" /> -->

</head>

<body class="signup-page sidebar-collapse">

{% block content %}
<nav class="navbar navbar-expand-lg bg-rose">
  <img src="../static/img/kit-11.png" style="width: 8%; margin-left: 25px;">
  <div class="form-group col-md-9">
    <h3 class="card-title text-center" style="color: white; width: 100%; margin-left: 40px"><b>ONLINE EXAMINATION SYSTEM</b></h3>
    </div>
</nav>

<div class="page-header header-filter" filter-color="purple" style="background-image: url('../static/img/kit.jpg')">
  <div class="page-header header-filter" filter-color="purple" >
    <div class="container">
      <div class="card card-signup center">
        <h2 class="card-title text-center">Register</h2>
        <form style="width: 100%;" name="form" method="POST" zaction="{% url 'register' %}" enctype="multipart/form-data">
                    {% csrf_token %}
                    <!-- <form class="form" method="" action=""> -->
                    <table class="center">
                    <tr>
                    <td>
                    <div class="form-group">
                      <div class="input-group">
                      <div class="input-group-prepend">
                        <span class="input-group-text">
                      <i class="material-icons">account_circle</i>
                         </span>
                        </div>
                     <input type="text" required pattern="[a-z-A-Z_.-]*" class="form-control" name="firstname" id="firstname" required="true" placeholder="First Name..."/>
                      </div>
                    </div>
                    </td>
                       <!-- &nbsp; &nbsp;  &nbsp;  &nbsp;  --> 
                    <td>
                          <div class="form-group">
                            <!-- sokmeng -->
                          <div class="input-group" style="margin-left: 55px;width: 200px">
                            <!--sokmeng-->
                     <!--        <div class="input-group-prepend">
                              
                        </div> -->
                         <input type="text" class="form-control" pattern="[0-9a-zA-Z_.-]*" name="lastname" required="true" placeholder="Last Name..."/>
                          </div>
                          </div>
                          </td>
                        </tr>

                        <tr>
                          <td>
                          <div class="form-group">
                          <div class="input-group">
                            <div class="input-group-prepend">
                              <span class="input-group-text">
                            <i class="material-icons">email</i>
                               </span>
                        </div>
                     <input type="email" class="form-control" name="email" pattern="[0-9a-zA-Z@._\+\-]+$"  required="true" placeholder="Email..."/>
                      </div>
                    </div>
                          </td>
                          <td>
                          <div class="form-group">
                          <div class="input-group">
                            <div class="input-group-prepend">
                              <span class="input-group-text">
                            <i class="material-icons">phone</i>
                               </span>
                        </div>
                     <input type="text" class="form-control" pattern="[-+()\\s0-9]+$" name="phonenumber"  required="true" placeholder="Mobile Phone..."/>
                      </div>
                    </div>
                          </td>
                          </tr>
                          <tr>
                            <td>
                          
                          <div class="form-group">
                          <div class="input-group">
                            <div class="input-group-prepend">
                              <span class="input-group-text">
                            <i class="material-icons">school</i>
                               </span>
                        </div>
                     <input type="text" class="form-control" name="sname" pattern="[0-9a-zA-Z_.-]*" required="true" placeholder="School Name..."/>
                      </div>
                    </div>
                          </td>
                            <td>
                         <div class="form-group">
                          <div class="input-group">
                            <div class="input-group-prepend">
                              <span class="input-group-text">
                            <i class="material-icons">date_range</i>
                               </span>
                        </div>
                     <input type="date" class="form-control" name="birthday"  required="true"/>
                      </div>
                    </div>
                          </td>
                          </tr>
                          <tr>
                           <th> 
                          <div class="form-group">
                          <div class="input-group">
                            <div class="input-group-prepend">
                              <span class="input-group-text">
                              <i class="material-icons">add_location</i>
                               </span>
                        </div>
                     <input type="text" class="form-control" name="address"  required="true" placeholder="Address..."/>
                      </div>
                    </div>
                          </th>
                          </tr>
                          <div>
                          <tr>
                            <td>
                              <b style="margin-left: 5px;">Candidate Profile</b>
                              <br>
                               <input required="true" id="card_id" value="card_id" name="card_id" class="btn btn-round add-btn" type="file" accept="image/*" onChange="validateAndUpload(this);"/>
                            </td>
                            <td>
                            <b style="margin-left: 5px;">Student ID Card</b>
                            <br>
                             <input required="true" id="student_profile" value="student_profile" name="student_profile" class="btn btn-round add-btn" type="file" accept="image/*" onChange="validateAndUpload(this);" />
                            </td>
                          </tr>
                          </div>
                        <br>
                        <br>
                      <tr>
                        <td>
                          <label for="city" style="color:black;"><b>CITY</b></label>
                          <select id="city" name="city" style="border-radius: 5px; padding: 6px; width: 90%; border: 5px;" required="True">
                            <option value="Tokyo">Tokyo</option>
                            <option value="Ozaka">Ozaka</option>
                            <option value="Kyoto">Kyoto</option>
                          </select>
                        </td>

                        <td>
                          <label for="country" style="color: black;"><b>COUNTRY</b></label>
                          <select id="country" name="country" style="border-radius: 5px; padding: 6px; width: 100%; border: 5px" required="True">
                            <option value="Japan">Japan</option>
                            <option value="India">India</option>
                            <option value="USA">USA</option>
                          </select>
                        </td>
                      </tr>
                      
                      <tr>
                        <td>
                      <div class="form-check">
                        <label class="form-check-label">
                          <input class="form-check-input" type="checkbox" value="" />
                          <span class="form-check-sign">
                            <span class="check"></span>
                          </span>
                          I agree to the
                          <a href="#something">terms and conditions</a>.
                        </label>
                        </div>
                                </td>
                              </tr>
                        </table>
                    <div class="text-center">
                      <input src="{% url 'model_form_upload' %}" type="submit" value="Register"/>
                    </div>
                 </form>
              </div>
            </div>
            </div>
          </div>
  
  <!-- Advanced Modal -->
    <div class="modal hide fade" id="takephoto" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-login" role="document">
        <div class="modal-content">
          <div class="modal-body">
                  <div class="card-body">
                      <!-- <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                    </div> -->
                          <h3 id="myModalLabel" style="text-align: center;">Camara</h3>
                          <div class="text-center">
                          <p><b>Please Fill above information before take photo!</b></p>
                          <p>please click Allow to capture the photo.</p>
                          </div>
                      </div>
                      <div class="modal-body">
                        <!-- Configure a few settings -->
                        <script language="JavaScript">
                          document.write( webcam.get_html(370, 250) );
                        </script>
                      </div>
                  </div>
                 <div class="modal-footer">
                        <a class="btn" data-dismiss="modal" aria-hidden="true" style="background-color: wheat;">Close</a>
                        <button class="btn btn-primary" onClick="take_snapshot()">Capture Photo</button>
                </div>               
            </div>
        </div>
    </div>


{% endblock content %}

  {% block extra_js %}
  <!-- Code to handle the server response -->
    <script type="text/javascript" src="{% static 'js/material-kit.js' %}"></script>

    <script src="{% static 'js/core/jquery.min.js' %}"></script>
    <script src="{% static 'js/core/popper.min.js' %}"></script>
    <script src="{% static 'js/core/bootstrap-material-design.min.js' %}"></script>
    <script language="JavaScript">

    var input = document.querySelector("[name=firstname]");
    input.b = function(event) {
        event.target.setCustomValidity("");
    };
    input.oninvalid = function(event) {
        event.target.setCustomValidity("Special characters are not allowed.");
    };
    var input = document.querySelector("[name=lastname]");
    input.oninput = function(event) {
        event.target.setCustomValidity("");
    };
    input.oninvalid = function(event) {
        event.target.setCustomValidity("Special characters are not allowed.");
    };
    var input = document.querySelector("[name=sname]");
    input.oninput = function(event) {
        event.target.setCustomValidity("");
    };
    input.oninvalid = function(event) {
        event.target.setCustomValidity("Special characters are not allowed.");
    };
    var input = document.querySelector("[name=phonenumber]");
    input.oninput = function(event) {  
        event.target.setCustomValidity("");
    };
    input.oninvalid = function(event) {
        event.target.setCustomValidity("Characters are not allowed.");
    };
    var input = document.querySelector("[name=email]");
    input.oninput = function(event) {
        event.target.setCustomValidity("");
    };
    input.oninvalid = function(event) {
        event.target.setCustomValidity("Please Enter the correct Email");
    };

    function validateAndUpload(input){
    var URL = window.URL || window.webkitURL;
    var file = input.files[0];

    if (file) {
        var image = new Image();

        image.onload = function() {
            if (this.width) {
                 console.log('Image has width, I think it is real image');
                 //TODO: upload to backend
            }
        };

        image.src = URL.createObjectURL(file);
    }
};​

    function take_snapshot() {    
      var firstname = document.getElementById('firstname').value;
      webcam.set_api_url('/save_image/'+escape(firstname)+'/' );
      webcam.set_hook( 'onComplete', 'my_completion_handler' );
      // take snapshot and upload to server
      webcam.snap();
      alert("Your Photo has been saved!")
    }
    function my_completion_handler(msg) {
      if (msg.match(/(\/media\/\S+)/)) {
        var image_url = RegExp.$1;
        // show JPEG image in page
        document.getElementById('fotoview').innerHTML =
          '<label>Fotografía</label>' +
          '<img src="' + image_url + '" class="img-polaroid" >';
        // reset camera for another shot
        webcam.reset();
        alert("Your Photo has been saved!")
      }
      else alert("Python Error: " + msg);
    }
  </script>
{% endblock extra_js %}
</body>
</html>